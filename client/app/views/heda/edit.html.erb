<h1>Configuration Heda</h1>

<%= form_with(model: @heda, local: true) do |form| %>
  <% if @heda.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@heda.errors.count, "error") %> prohibited this heda from being saved:</h2>

      <ul>
        <% @heda.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <p>
    La tablette principale est celle où les mélanges se passent et où tu déposes tes pots.<br/>
    Veuillez inscrire le numéro de le tablette désignée pour être principale.<br/>
    Voici la liste des tablettes:
  </p>

  <div class="field">
    <%= form.label :shelf_id %>
    <%= form.text_field :shelf_id %>
  </div>

  <p>
    Pour pas mal toute les mesures, faire un marque sur l'axe centrale et se mesurer à partir du zéro.
  </p>

  <div class="field">
    <%= form.label :user_coord_offset_x %>
    <%= form.number_field :user_coord_offset_x, step: 0.01 %>
  </div>

  <div class="field">
    <%= form.label :user_coord_offset_y %>
    <%= form.number_field :user_coord_offset_y, step: 0.01 %>
  </div>

  <div class="field">
    <%= form.label :user_coord_offset_z %>
    <%= form.number_field :user_coord_offset_z, step: 0.01 %>
  </div>

  <table style="width:100%">
    <tr>
      <td><b>Variable</b></td>
      <td><b>Valeur</b></td>
      <td><b>Valeur par défaut</b></td>
      <td><b>Notes</b></td>
    </tr>
    <tr>
      <td colspan="4"><h3>Maximum</h3></td>
    </tr>
    <tr>
      <td><%= form.label :max_x %></td>
      <td><%= form.number_field :max_x , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :max_y %></td>
      <td><%= form.number_field :max_y , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :max_z %></td>
      <td><%= form.number_field :max_z , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :max_h %></td>
      <td><%= form.number_field :max_h , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :max_v %></td>
      <td><%= form.number_field :max_v , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :max_t %></td>
      <td><%= form.number_field :max_t , step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td colspan="4"><h3>Référencement</h3></td>
    </tr>
    <tr>
      <td><%= form.label :home_position_t %></td>
      <td><%= form.number_field :home_position_t, step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :home_position_y %></td>
      <td><%= form.number_field :home_position_y, step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :home_position_x %></td>
      <td><%= form.number_field :home_position_x, step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td colspan="4"><h3>Camera</h3></td>
    </tr>
    <tr>
      <td><%= form.label :detect_height %></td>
      <td><%= form.number_field :detect_height, step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :camera_radius %></td>
      <td><%= form.number_field :camera_radius, step: 0.01 %></td>
      <td></td>
      <td>Faire un trait vis-à-vis la caméra, faire un trait vis-a-vis le centre de rotation et mesurer cette distance.</td>
    </tr>
    <tr>
      <td><%= form.label :closeup_distance %></td>
      <td><%= form.number_field :closeup_distance, step: 0.01 %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :camera_focal_point %></td>
      <td><%= form.text_field :camera_focal_point, readonly: true %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :camera_width %></td>
      <td><%= form.number_field :camera_width %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= form.label :camera_height %></td>
      <td><%= form.number_field :camera_height %></td>
      <td></td>
      <td></td>
    </tr>
  </table> 

  <div class="field">
    
    
  </div>

  <h3>Autre</h3>

  <p>
  Pour entrer cette donnée, déplacer le bras au centre de l'axe x. Ensuite mettre le bras à theta=0. Mettre outils crayon dans la pince. Faire une marque.
  Déplacer theta = 180. Faire une marque. Divisier la distance en 2.

  Ça ne fonctionne pas trop. Simplement faire un trait vis-à-vis le centre de l'outil, faire un trait vis-a-vis le centre de rotation et mesurer cette distance.
  </p>

  <div class="field">
    <%= form.label :gripper_radius %>
    <%= form.number_field :gripper_radius, step: 0.01 %>
  </div>

  <div class="field">
    <%= form.label :grip_offset %>
    <%= form.number_field :grip_offset %>
  </div>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>

<%= render :file => 'jar_formats/index' %>

<h2>Calibrate camera</h2>

<p>
La tablette de travail doit être libre.
</p>

<p>
Insérer un pot de référence dans les pinces et remplir le forumulaire suivant.
</p>

<%= form_with url: heda_run_path(cmd: "calibrate") do |form| %>
  <%= form.label :jar_height %>
  <%= form.number_field :jar_height %>
  <%= form.submit "Calibrate" %>
<% end %>
